<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alan Holding Digital Solutions | Web Development & AI Chatbots</title>
    <script src="https://cdn.botpress.cloud/webchat/v2.4/inject.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      // Wait for the page to load
      window.addEventListener('DOMContentLoaded', function() {
        // Check if Botpress is loaded
        function checkBotpress() {
          if (window.botpress) {
            setupBotpress();
          } else {
            setTimeout(checkBotpress, 300);
          }
        }
        
        // Set up Botpress with configuration
        function setupBotpress() {
          // Initialize with standard configuration
          window.botpress.init({
            "botId": "c23553ca-8e78-494d-9cc1-b5d6341c54f5",
            "configuration": {
              "botName": "Oliver",
              "color": "#5eb1ef",
              "themeMode": "dark",
              "fontFamily": "inter",
              "radius": 2.5,
              
              // Welcome message settings
              "showConversationStart": true,
              "enableWelcome": true,
              "welcomeMessage": "Welcome to Alan Holding Digital Solutions! I'm Oliver, your personal digital advisor. How can I help you today?",
              
              // Force conversation to start
              "conversationDuration": 0,
              "disableAnimations": true,
              "forceOpen": true
            },
            "clientId": "618d8e6d-457b-449e-b895-4cf79049220d"
          });
          
          // Add event listener for when chat is ready
          window.botpress.on("webchat:ready", function() {
            // First show the webchat
            window.botpress.sendEvent({ type: 'show' });
            
            // Now manually inject a greeting message
            setTimeout(function() {
              // Access the internal messaging system
              try {
                // Try to use the internal messaging API
                const message = {
                  type: 'text',
                  payload: {
                    text: 'Welcome to Alan Holding Digital Solutions! I\'m Oliver, your personal digital advisor. How can I help you today?'
                  },
                  userId: 'bot'
                };
                
                // Dispatch the message
                window.botpressWebChat.onEvent({
                  type: 'message',
                  message: message
                });
              } catch (e) {
                console.log("Could not use internal API, trying alternative...");
                
                // Visual fallback - inject HTML directly into the chat if API fails
                try {
                  const chatContainer = document.querySelector('.bpwChatBubbles');
                  if (chatContainer) {
                    const botMessageHTML = `
                      <div class="bpw-chat-bubble bpw-bot-bubble">
                        <div class="bpw-chat-bubble-content">
                          <span>Welcome to Alan Holding Digital Solutions! I'm Oliver, your personal digital advisor. How can I help you today?</span>
                        </div>
                      </div>
                    `;
                    chatContainer.innerHTML += botMessageHTML;
                  }
                } catch (e2) {
                  console.log("Could not inject message visually either.");
                }
              }
            }, 1500);
          });
        }
        
        // Start the process
        setTimeout(checkBotpress, 500);
      });
    </script>
  </body>
</html>